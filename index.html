<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parallax</title>
    <style>
        @import url("https://fonts.googleapis.com/css?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&display=swap");

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            height: 200vh;
            font-family: "DM Mono", monospace;
            background-color: #2e2e2e;
            color: #fff;
        }

        /* ===== Wrapper Section ===== */
        .projects-section {
            margin-top: 25vh;
            width: 100%;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            /* jarak antara filter & slider */
        }

        /* ===== Filter Pills ===== */
        .filter-section {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            /* jarak ke slider */
        }

        .filter-pill {
            background-color: #444;
            color: #fff;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .filter-pill:hover,
        .filter-pill.active {
            background-color: #666;
        }

        /* ===== Slider & Track ===== */
        .slider {
            position: relative;
            width: 100%;
            overflow: hidden;
            user-select: none;
            display: flex;
            justify-content: center;
            /* center slide-track */
        }

        .slide-track {
            display: flex;
            align-items: center;
            gap: 20px;
            /* jarak antar card */
        }

        /* ===== Slide Card ===== */
        .slide {
            flex-shrink: 0;
            width: 500px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        @media (max-width: 1000px) {
            .slide {
                width: 175px;
            }
        }

        .slide-image {
            width: 100%;
            height: 350px;
            overflow: hidden;
        }

        .slide-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            will-change: transform;
            transform: scale(2.25);
            user-select: none;
        }

        .slide-text {
            margin-top: 10px;
            text-align: center;
            max-width: 100%;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .slide:hover .slide-text {
            opacity: 1;
            transform: translateY(0);
        }

        .project-title {
            font-weight: 500;
            font-size: 1rem;
            margin-bottom: 20px;
            margin-top: 20px;
            color: #fff;
        }

        .project-desc {
            font-weight: 300;
            font-size: 0.85rem;
            color: #ccc;
            line-height: 1.4;
        }

        .project-skills {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }

        .skill-pill {
            background-color: #444;
            color: #fff;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 300;
            transition: background 0.3s ease;
        }

        .skill-pill:hover {
            background-color: #666;
        }

        /* Overlay text */
        .slide-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            padding: 10px 15px;
            pointer-events: none;
            z-index: 10;
            transition: opacity 0.3s ease;
            opacity: 0;
        }

        .slide-overlay.active {
            opacity: 1 !important;
        }

        .slide-overlay.active .project-desc {
            opacity: 1;
            transform: translateY(0);
        }

        /* Arrow tetap di kanan bawah */
        .project-arrow {
            position: absolute;
            right: 10px;
            bottom: 10px;
            width: 16px;
            height: 16px;
        }

        .project-arrow svg {
            stroke: #fff;
            stroke-width: 2;
        }
    </style>
</head>

<body>
    <section class="projects-section">
        <div class="filter-section">
            <span class="filter-pill active" data-category="All">All</span>
            <span class="filter-pill" data-category="web">Web</span>
            <span class="filter-pill" data-category="mobile">Mobile</span>
        </div>

        <div class="slider">
            <div class="slide-track"></div>
        </div>
    </section>

    <script>
        const sliderData = [
            {
                img: "images/build-1.jpg",
                title: "Smart Home Automation",
                desc: "Sistem otomatisasi rumah pintar yang memungkinkan pengguna mengontrol lampu, AC, dan perangkat elektronik melalui aplikasi web, dengan jadwal dan notifikasi real-time.",
                skills: ["React", "Tailwind", "Node.js"],
                category: "web"
            },
            {
                img: "images/build-2.jpg",
                title: "E-Commerce Platform",
                desc: "Platform e-commerce modern dengan fitur katalog produk, keranjang belanja, pembayaran online, dan manajemen pesanan untuk pengalaman belanja yang cepat dan aman.",
                skills: ["React", "Tailwind", "Node.js"],
                category: "web"
            },
            {
                img: "images/build-3.jpg",
                title: "Fitness Tracker App",
                desc: "Aplikasi mobile untuk memantau aktivitas olahraga, tidur, dan pola makan, serta memberikan rekomendasi harian agar pengguna mencapai target kebugaran mereka.",
                skills: ["Flutter", "Firebase", "Chart.js"],
                category: "mobile"
            },
            {
                img: "images/build-4.jpg",
                title: "Recipe & Meal Planner App",
                desc: "Aplikasi mobile yang membantu pengguna menemukan resep masakan sehat, membuat daftar belanja, dan merencanakan menu mingguan dengan notifikasi pengingat.",
                skills: ["Flutter", "Firebase", "REST API"],
                category: "mobile"
            }
        ];

        const config = { scrollSpeed: 1.75, lerpFactor: 0.05, maxVelocity: 150 };
        let filteredData = [...sliderData];

        const state = {
            currentX: 0,
            targetX: 0,
            slideWidth: 390,
            slides: [],
            isDragging: false,
            startX: 0,
            lastX: 0,
            lastMouseX: 0,
            lastScrollTime: Date.now(),
            isMoving: false,
            velocity: 0,
            lastCurrentX: 0,
            dragDistance: 0,
            hasActuallyDragged: false,
            isMobile: false,
            currentFilter: "All"
        };

        // ==== MOBILE CHECK ====
        function checkMobile() { state.isMobile = window.innerWidth < 1000; }

        // ==== CREATE SLIDE ====
        function createSlideElement(data) {
            const slide = document.createElement("div");
            slide.className = "slide";
            if (state.isMobile) slide.style.width = "175px";

            const imageContainer = document.createElement("div");
            imageContainer.className = "slide-image";
            const img = document.createElement("img");
            img.src = data.img;
            img.alt = data.title;
            imageContainer.appendChild(img);

            const textContainer = document.createElement("div");
            textContainer.className = "slide-text";

            const title = document.createElement("p");
            title.className = "project-title";
            title.textContent = data.title;

            const description = document.createElement("p");
            description.className = "project-desc";
            description.textContent = data.desc || "";

            const skillsContainer = document.createElement("div");
            skillsContainer.className = "project-skills";
            data.skills.forEach(skill => {
                const skillEl = document.createElement("span");
                skillEl.className = "skill-pill";
                skillEl.textContent = skill;
                skillsContainer.appendChild(skillEl);
            });

            textContainer.appendChild(title);
            textContainer.appendChild(description);
            textContainer.appendChild(skillsContainer);

            slide.appendChild(imageContainer);
            slide.appendChild(textContainer);
            slide.dataset.category = data.category;

            return slide;
        }

        // ==== INITIALIZE SLIDES ====
        function initializeSlides() {
            const track = document.querySelector(".slide-track");
            track.innerHTML = "";
            state.slides = [];

            checkMobile();
            state.slideWidth = state.isMobile ? 215 : 390;

            // Hanya buat copy jika lebih dari 1 slide (untuk infinite scroll)
            let copies = filteredData.length > 1 ? 6 : 1;

            filteredData.forEach(data => {
                const slide = createSlideElement(data);
                track.appendChild(slide);
                state.slides.push(slide);
            });

            // Kalau hanya 1 slide, posisikan di tengah
            if (filteredData.length === 1) {
                track.style.display = "flex";
                track.style.justifyContent = "center";
                track.style.transform = "translate3d(0,0,0)";
                state.currentX = 0;
                state.targetX = 0;
            } else {
                track.style.display = "flex";
                track.style.justifyContent = "flex-start";

                // Duplikasi slides untuk infinite scroll
                for (let i = 1; i < copies; i++) {
                    filteredData.forEach(data => {
                        const slide = createSlideElement(data);
                        track.appendChild(slide);
                        state.slides.push(slide);
                    });
                }

                const startOffset = -(filteredData.length * state.slideWidth * 2);
                state.currentX = startOffset;
                state.targetX = startOffset;
                track.style.transform = `translate3d(${state.currentX}px,0,0)`;
            }
        }

        // ==== UPDATE SLIDE POSITIONS ====
        function updateSlidePositions() {
            const track = document.querySelector(".slide-track");
            if (filteredData.length <= 1) return; // tidak scroll kalau 1 item
            const sequenceWidth = state.slideWidth * filteredData.length;

            if (state.currentX > -sequenceWidth * 1) {
                state.currentX -= sequenceWidth;
                state.targetX -= sequenceWidth;
            } else if (state.currentX < -sequenceWidth * 4) {
                state.currentX += sequenceWidth;
                state.targetX += sequenceWidth;
            }

            track.style.transform = `translate3d(${state.currentX}px, 0, 0)`;
        }

        // ==== PARALLAX ====
        function updateParallax() {
            const viewportCenter = window.innerWidth / 2;
            state.slides.forEach(slide => {
                if (slide.style.display === "none") return;
                const img = slide.querySelector("img");
                if (!img) return;
                const slideRect = slide.getBoundingClientRect();
                if (slideRect.right < -500 || slideRect.left > window.innerWidth + 500) return;
                const slideCenter = slideRect.left + slideRect.width / 2;
                const distanceFromCenter = slideCenter - viewportCenter;
                const parallaxOffset = distanceFromCenter * -0.25;
                img.style.transform = `translateX(${parallaxOffset}px) scale(2.25)`;
            });
        }

        // ==== ANIMATE ====
        function updateMovingState() {
            state.velocity = Math.abs(state.currentX - state.lastCurrentX);
            state.lastCurrentX = state.currentX;
            const isSlowEnough = state.velocity < 0.1;
            const hasBeenStillLongEnough = Date.now() - state.lastScrollTime > 200;
            state.isMoving = state.hasActuallyDragged || !isSlowEnough || !hasBeenStillLongEnough;
            document.documentElement.style.setProperty("--slider-moving", state.isMoving ? "1" : "0");
        }

        function animate() {
            state.currentX += (state.targetX - state.currentX) * config.lerpFactor;
            updateMovingState();
            updateSlidePositions();
            updateParallax();
            requestAnimationFrame(animate);
        }

        // ==== FILTER LOGIC ====
        function applyFilter(category) {
            state.currentFilter = category;
            filteredData = category === "All" ? [...sliderData] : sliderData.filter(d => d.category === category);
            initializeSlides();
        }

        // ==== EVENT LISTENERS ====
        function initializeEventListeners() {
            const slider = document.querySelector(".slider");
            slider.addEventListener("wheel", e => {
                if (Math.abs(e.deltaX) > 0) { e.preventDefault(); state.lastScrollTime = Date.now(); state.targetX += -e.deltaX * config.scrollSpeed; }
            }, { passive: false });

            slider.addEventListener("touchstart", e => { state.isDragging = true; state.startX = e.touches[0].clientX; state.lastX = state.targetX; });
            slider.addEventListener("touchmove", e => { if (!state.isDragging) return; const deltaX = (e.touches[0].clientX - state.startX) * 1.5; state.targetX = state.lastX + deltaX; });
            slider.addEventListener("touchend", () => state.isDragging = false);

            slider.addEventListener("mousedown", e => { state.isDragging = true; state.startX = e.clientX; state.lastMouseX = e.clientX; state.lastX = state.targetX; });
            document.addEventListener("mousemove", e => { if (!state.isDragging) return; const deltaX = e.clientX - state.lastMouseX; state.targetX += deltaX; state.lastMouseX = e.clientX; });
            document.addEventListener("mouseup", () => state.isDragging = false);

            window.addEventListener("resize", initializeSlides);

            // FILTER PILLS
            document.querySelectorAll(".filter-pill").forEach(pill => {
                pill.addEventListener("click", () => {
                    document.querySelectorAll(".filter-pill").forEach(p => p.classList.remove("active"));
                    pill.classList.add("active");
                    applyFilter(pill.dataset.category);
                });
            });
        }

        // ==== INIT SLIDER ====
        function initializeSlider() { initializeSlides(); initializeEventListeners(); animate(); }
        document.addEventListener("DOMContentLoaded", initializeSlider);
    </script>


</body>

</html>